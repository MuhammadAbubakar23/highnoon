<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type="square-jelly-box" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
<div
  class="team-user-wrap console-body-wrapper inbox-container"
  data-scrollbar="true"
  tabindex="-1"
  style="overflow: hidden; outline: none"
>
  <div class="scroll-content">
    <div class="row h-auto justify-content-center">
      <div class="col-md-11">
        <div class="tab-content" id="nav-tabContent">
          <div
            id="members"
            class="tab-pane fade list-group-section active show"
            role="tabpanel"
            aria-labelledby="members-tab"
          >
            <div class="w-100 inbox-container">
              <div class="filter-container">
                <div class="row">
                  <div class="col-md-5">
                    <ul class="list-group list-group-horizontal border-0">
                      <li class="list-group-item border-0 p-0">
                        <div class="icon-input">
                          <i class="fa-light fa-magnifying-glass"></i>
                          <input
                            class="form-control"
                            placeholder="Search .. "
                          />
                        </div>
                      </li>
                      <li
                        class="list-group-item border-0 refreshicon iconHover iconButton medium rounded-circle"
                        aria-label="..."
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        data-bs-original-title="Refresh"
                      >
                        <i class="fal fa-redo"></i>
                      </li>
                      <li
                        class="list-group-item after-select-fun iconHover iconButton medium rounded-circle"
                        aria-label="..."
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        data-bs-original-title="Delete"
                        style="display: none"
                      >
                        <i class="fal fa-trash"></i>
                      </li>
                    </ul>
                  </div>
                  <div class="col-md-7">
                    <div class="d-flex align-items-center justify-content-end">
                      <a
                        routerLink="/connect/console/create-stage"
                        class="me-2"
                      >
                        <button type="button" class="btn btn-success">
                          <i class="fal fa-plus me-2"></i>
                          Create Stage
                        </button>
                      </a>
                      <!-- <a
                        class="btn btn-success ice me-2"
                        data-bs-toggle="offcanvas"
                        href="#invitemembers"
                        role="button"
                        aria-controls="invitemembers"
                      >
                        <i class="fa-light fa-plus"></i> Invite Members
                      </a> -->
                    </div>
                  </div>
                </div>
              </div>
              <div
              class="query-container perfect-scrollbar"
              data-scrollbar="true"
              tabindex="-1"
              style="overflow-y: auto; outline: none"
              >
                <div class="scroll-content">
                  <div
                    class="alert alert-secondary text-center email-info-alert p-2"
                    role="alert"
                  >
                    All <strong>09</strong> candidates on this page are
                    selected.
                    <a
                      href="javascript:void(0);"
                      class="all-conversation fw-bold sky btn"
                      >Select all 09 Candidates</a
                    >
                    <a
                      href="javascript:void(0);"
                      class="clear-selection"
                      style="display: none"
                      >Clear selection</a
                    >
                  </div>
                  <div class="table-section">







                    <table class="table">
                      <thead>
                        <tr>
                          <!-- <th *ngIf="showCheckboxes">
                            <ul class="list-group list-group-horizontal border-0 p-0">
                              <li class="list-group-item border-0 all-check-boxes p-0">
                                <input class="form-check-input" type="checkbox" aria-label="..." data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-original-title="Check All">
                              </li>
                            </ul>
                            -->
                            <th>ID</th>
                          <th *ngFor="let column of columnNames">{{ column }}</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of reqStageItems,let i=index;">
                          <td *ngIf="pageNumber == 1">{{ i + 1 }}</td>
                          <td *ngIf="pageNumber > 1">
                            {{ i + 1 + pageSize * (pageNumber - 1) }}
                          </td>
                          <td *ngFor="let column of desColumns">
                              <a *ngIf="column == 'username' && item[column]=='';else assignment"
                              (click)="assignUser(item.requestStageId)"
                              data-bs-toggle="modal"
                              data-bs-target="#adddependent" role="button" aria-controls="updateattendance" class="btn btn-outline-primary">Assign Approver</a>
                             <ng-template #assignment>{{item[column]}}</ng-template>
                            </td>
                          <td>
                            <div class="dropdown w-auto" data-bs-toggle="tooltip" data-bs-placement="top">
                              <button class="iconButton small iconHover d-inline-block" id="dropdownMenuButton1"
                                data-bs-toggle="dropdown" aria-expanded="true">
                                <i class="far fa-ellipsis-v"></i>
                              </button>
                              <ul class="dropdown-menu custom-dropdown" aria-labelledby="dropdownMenuButton1">
                                <li>
                                  <a class="dropdown-item p-1" (click)="editStage(item.requestStageId)">
                                    <button class="iconButton dropdown-iconBtn small" >
                                      <i class="fal fa-edit"></i></button>Edit
                                  </a>
                                </li>
                                <li>
                                  <a class="dropdown-item p-1" (click)="deleteStage(item.requestStageId)">
                                    <button class="iconButton dropdown-iconBtn small dropdown-item p-1"  >
                                      <i class="fal fa-trash"></i>
                                    </button>
                                    Delete
                                  </a>
                                </li>
                              </ul>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <ng-container *ngIf="totalRecords > 10">
                  <div class="me-5">
                    <ul class="pagination justify-content-end">
                      <li class="page-item">
                        <a
                          class="page-link"
                          (click)="prevPage()"
                          [attr.disabled]="pageNumber === 1"
                          >Previous</a
                        >
                      </li>
                      <li
                        class="page-item"
                        *ngFor="let page of totalPagesArray()"
                      >
                        <a
                          class="page-link"
                          (click)="changePage(page)"
                          [class.active]="pageNumber === page"
                          [style.color]="pageNumber === page ? 'blue' : 'black'"
                          >{{ page }}</a
                        >
                      </li>
                      <li class="page-item">
                        <a
                          class="page-link"
                          (click)="nextPage()"
                          [attr.disabled]="pageNumber === totalPages"
                          >Next</a
                        >
                      </li>
                    </ul>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
          <div
            id="pending"
            class="tab-pane fade list-group-section"
            role="tabpanel"
            aria-labelledby="pending-tab"
          >
            <div class="w-100 inbox-container">
              <div class="filter-container">
                <div class="row">
                  <div class="col-md-5">
                    <ul class="list-group list-group-horizontal border-0">
                      <li class="list-group-item border-0 p-0">
                        <div class="icon-input">
                          <i class="fa-light fa-magnifying-glass"></i>
                          <input
                            class="form-control"
                            placeholder="Search .. "
                          />
                        </div>
                      </li>
                      <li
                        class="list-group-item border-0 refreshicon iconHover iconButton medium rounded-circle"
                        aria-label="..."
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        data-bs-original-title="Refresh"
                      >
                        <i class="fal fa-redo"></i>
                      </li>
                      <li
                        class="list-group-item after-select-fun iconHover iconButton medium rounded-circle"
                        aria-label="..."
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        data-bs-original-title="Delete"
                        style="display: none"
                      >
                        <i class="fal fa-trash"></i>
                      </li>
                    </ul>
                  </div>
                  <div class="col-md-7">
                    <div class="d-flex align-items-center justify-content-end">
                      <a routerLink="/console/create-stage" class="me-2">
                        <button type="button" class="btn btn-success">
                          <i class="fal fa-plus me-2"></i>
                          Create State
                        </button>
                      </a>
                      <!-- <a
                        class="btn btn-success ice me-2"
                        data-bs-toggle="offcanvas"
                        href="#invitemembers"
                        role="button"
                        aria-controls="invitemembers"
                      >
                        <i class="fa-light fa-plus"></i> Invite Members
                      </a> -->
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="query-container perfect-scrollbar"
                data-scrollbar="true"
                tabindex="-1"
                style="overflow: hidden; outline: none"
              >
                <div class="scroll-content">
                  <div
                    class="alert alert-secondary text-center email-info-alert p-2"
                    role="alert"
                  >
                    All <strong>09</strong> candidates on this page are
                    selected.
                    <a
                      href="javascript:void(0);"
                      class="all-conversation fw-bold sky btn"
                      >Select all 09 Candidates</a
                    >
                    <a
                      href="javascript:void(0);"
                      class="clear-selection"
                      style="display: none"
                      >Clear selection</a
                    >
                  </div>
                  <div class="table-section">

                  </div>
                </div>
                <div
                  class="scrollbar-track scrollbar-track-x"
                  style="display: none"
                >
                  <div
                    class="scrollbar-thumb scrollbar-thumb-x"
                    style="width: 1500px; transform: translate3d(0px, 0px, 0px)"
                  ></div>
                </div>
                <div
                  class="scrollbar-track scrollbar-track-y"
                  style="display: none"
                >
                  <div
                    class="scrollbar-thumb scrollbar-thumb-y"
                    style="height: 755px; transform: translate3d(0px, 0px, 0px)"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
  class="modal fade"
  id="adddependent"
  tabindex="-1"
  aria-labelledby="adddependentLabel"
  aria-modal="true"
  role="dialog"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title line-head" id="adddependentLabel">
          Assign Approver
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <form [formGroup]="reqStageForm">
        <div class="modal-body">

          <!-- <div class="mb-3">
            <label for="">Name</label>
            <input
              class="form-control"
              formControlName="name"
              [class.is-invalid]="dF['name'].invalid && dF['name'].touched"
              [class.is-valid]="dF['name'].valid && dF['name'].touched"
            />
            <div class="invalid-feedback">
              <div *ngIf="dF['name'].errors?.['required']">
                Name is required.
              </div>
              <div *ngIf="dF['name'].errors?.['maxlength']">
                Name must be less than 200 characters.
              </div>
            </div>
            <div class="valid-feedback">Looks good!</div>
          </div>
          <div class="mb-3">
            <label for="">CNIC</label>
            <input
              class="form-control"
              formControlName="cnic"
              [class.is-invalid]="dF['cnic'].invalid && dF['cnic'].touched"
              [class.is-valid]="dF['cnic'].valid && dF['cnic'].touched"
            />
            <div class="invalid-feedback">
              <div *ngIf="dF['cnic'].errors?.['required']">
                CNIC is required.
              </div>
              <div *ngIf="dF['cnic'].errors?.['maxlength']">
                CNIC must be less than 100 characters.
              </div>
            </div>
            <div class="valid-feedback">Looks good!</div>
          </div>
          -->
          <div class="mb-3">
            <label for="">Select Approver</label>
            <select
              class="form-select"
              formControlName="approverId"
              [class.is-invalid]="
                rSF['approverId'].invalid && rSF['approverId'].touched
              "
              [class.is-valid]="rSF['approverId'].valid && rSF['approverId'].touched"
            >
            <option disabled [value]="0">
              Approver
            </option>
            <option
              [value]="user.categoryId"
              *ngFor="let user of users"
            >
              {{ user.firstName }}
            </option>
            </select>
            <div class="invalid-feedback">

              <div *ngIf="rSF['approverId'] && rSF['approverId'].errors">
                <div *ngIf="rSF['approverId'].errors?.['required']">
                  Iban Number must be less than 100  characters.
                </div>
                <div *ngIf="rSF['approverId'].errors?.['maxlength']">
                  User must be less than 100 characters.
                </div>
                </div>


            </div>
            <div class="valid-feedback">Looks good!</div>
          </div>
        </div>
      </form>

      <div class="modal-footer saltBg">
        <button
          type="button"
          class="btn btn-outline-secondary"
          data-bs-dismiss="modal"
          (click)="submitForm()"
          [class.disabled]="reqStageForm.invalid"
        >
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-primary adddependent"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</div>
  <app-toaster></app-toaster>
  <!-- data-bs-toggle="modal"
  data-bs-target="#adddependent" -->

  <!-- <td> <a data-bs-toggle="modal"
  data-bs-target="#adddependent" role="button" aria-controls="updateattendance" class="btn btn-outline-primary">Assign User</a></td> -->
